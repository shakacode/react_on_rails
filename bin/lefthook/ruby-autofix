#!/usr/bin/env bash
# Auto-fix Ruby files using rake autofix
set -euo pipefail

CONTEXT="${1:-staged}"
files="$(bin/lefthook/get-changed-files "$CONTEXT" '\.(rb|rake|ru)$')"

if [ -z "$files" ]; then
  echo "âœ… No Ruby files to autofix"
  exit 0
fi

if [ "$CONTEXT" = "all-changed" ]; then
  echo "ðŸŽ¨ Autofix on all changed Ruby files:"
else
  echo "ðŸŽ¨ Autofix on $CONTEXT Ruby files:"
fi
printf "  %s\n" $files

bundle exec rake autofix

echo "Completed auto-fixing all linting violations"
