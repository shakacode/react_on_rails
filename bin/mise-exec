#!/usr/bin/env zsh
# Wrapper script to run commands with mise-managed tool versions
# Usage: bin/mise-exec <command> [args...]
#
# This is needed because Conductor (and other non-interactive shells) don't
# source .zshrc, so mise's PATH ordering based on .tool-versions isn't active
# by default.
#
# If mise is not available, falls back to direct execution (for asdf/rbenv/nvm users).
#
# Examples:
#   bin/mise-exec ruby --version       # Uses .tool-versions Ruby
#   bin/mise-exec bundle exec rubocop  # Correct Ruby for linting
#   bin/mise-exec git commit -m "msg"  # Pre-commit hooks work correctly
#   bin/mise-exec pnpm install         # Uses .tool-versions Node
#
# See: https://github.com/shakacode/react_on_rails-demos/issues/105

if command -v mise &> /dev/null; then
  exec mise exec -- "$@"
else
  # Fall back to direct execution for non-mise users
  exec "$@"
fi
