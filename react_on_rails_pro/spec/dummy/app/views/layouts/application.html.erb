<!DOCTYPE html>
<html>
<head>
  <!-- TODO: should we import this as a part of ROR app -->
  <% unless request.path.include?('posts_page') %>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/9000.0.1/themes/prism.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/9000.0.1/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/9000.0.1/components/prism-markup.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/9000.0.1/components/prism-jsx.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/9000.0.1/components/prism-ruby.min.js"></script>
  <% end %>
  <% if content_for?(:title) %>
    <%= yield(:title) %>
  <% else %>
    <title>Dummy</title>
  <% end %>
  <%= yield :head %>
  <style>
      /* Critical CSS inlined to prevent FOUC (Flash of Unstyled Content)
         These styles ensure the layout renders correctly before the main CSS loads.
         See: https://github.com/shakacode/react_on_rails/issues/2100 */
      html {
          font-size: 16px !important;
      }
      /* Base layout styles */
      .flex { display: flex; }
      .flex-row { flex-direction: row; }
      .flex-col { flex-direction: column; }
      .flex-1 { flex: 1 1 0%; }
      .h-screen { height: 100vh; }
      .w-screen { width: 100vw; }
      /* Sidebar styles */
      .min-w-\[400px\] { min-width: 400px; }
      .max-w-\[400px\] { max-width: 400px; }
      .bg-slate-100 { background-color: #f1f5f9; }
      .bg-white { background-color: #ffffff; }
      .border-solid { border-style: solid; }
      .border-r-2 { border-right-width: 2px; }
      .border-slate-700 { border-color: #334155; }
      /* Spacing */
      .p-5 { padding: 1.25rem; }
      .px-2 { padding-left: 0.5rem; padding-right: 0.5rem; }
      /* Overflow handling */
      .overflow-y-auto { overflow-y: auto; }
      .overflow-x-hidden { overflow-x: hidden; }
      /* Typography (minimal for initial render) */
      .text-red-700 { color: #b91c1c; }
      .underline { text-decoration: underline; }
  </style>
  <!-- Preload CSS for faster loading -->
  <%= preload_pack_asset('client-bundle.css', as: 'style') %>
  <%= stylesheet_pack_tag('client-bundle',
                          media: 'all',
                          'data-turbo-track': 'reload') %>

  <%# async: true is the recommended approach for Shakapacker >= 8.2.0 (currently using 9.3.0).
      It enables React 18's Selective Hydration and provides optimal Time to Interactive (TTI).
      Use immediate_hydration feature to control hydration timing for Selective/Immediate Hydration.
      See docs/building-features/streaming-server-rendering.md
      skip_js_packs param is used for testing purposes to simulate hydration failure %>
  <% unless params[:skip_js_packs] == 'true' %>
    <%= javascript_pack_tag('client-bundle', 'data-turbo-track': 'reload', async: true) %>
  <% end %>
  <%= csrf_meta_tags %>
</head>
<body class="bg-white">
<div class="flex flex-row h-screen w-screen">
  <div class="flex flex-col overflow-y-auto p-5 bg-slate-100 border-solid border-r-2 border-slate-700 min-w-[400px] max-w-[400px]">
    <div class="flex flex-row">
      <img style="width: 70px; height: 62px;" src="/rorp_logo.png"/>
      <div class="px-2">
        <h1 class="page-header">
          React on Rails Pro
        </h1>
        <h3>
          By <a class="text-red-700 underline" target="_blank" href="https://www.shakacode.com/">ShakaCode</a>
        </h3>
      </div>
    </div>
    <%= render "shared/menu" %>
  </div>
  <div class="flex-1 overflow-x-hidden overflow-y-auto">
    <div class="p-5">
      <% flash.each do |key, value| %>
        <%= content_tag :div, value, class: "flash #{key}" %>
      <% end %>
      <div id="page-container">
        <%= yield %>
      </div>
      <!-- This is a placeholder for ReactOnRails to know where to render the store props for
       client side hydration -->
      <%= redux_store_hydration_data %>
    </div>
  </div>
</div>
</body>
</html>
