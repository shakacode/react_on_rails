# Lychee link checker configuration
# https://lychee.cli.rs

# Accept successful responses and permanent redirects
# 200 = OK, 308 = Permanent Redirect
accept = ["200", "308"]

# Retry failed requests (handles transient 502/503/504/429 errors)
max_retries = 4
retry_wait_time = 15

# Timeout for each request
timeout = 20

# Exclude patterns (migrated from markdown-link-check-config.json)
exclude = [
  # ============================================================================
  # DEVELOPMENT URLS
  # ============================================================================
  '^http://localhost',
  '^https://localhost',
  '^mailto:',

  # ============================================================================
  # SITES THAT BLOCK BOTS OR REQUIRE AUTH
  # ============================================================================
  '^https://(www\.)?npmjs\.(org|com)',  # Returns 403 for automated requests
  '^https://medium\.com',  # Returns 403 for automated requests
  '^https://www\.linkedin\.com',
  '^https://reactrails\.slack\.com',
  '^https://docs\.google\.com',  # Private docs require auth
  '^https://claude\.ai',  # Returns 403 for automated requests

  # ============================================================================
  # KNOWN DEAD OR PROBLEMATIC URLS
  # ============================================================================
  '^https://your-shared-addr\.c9users\.io',
  '^https://hichee\.com',
  '^https?://rubyonrails\.org/doctrine',  # DNS issues

  # ============================================================================
  # SSL CERTIFICATE ISSUES
  # ============================================================================
  # Expired, hostname mismatch, or verification failed
  '^https://(www\.)?blinkinc\.com',     # SSL certificate expired
  '^https://(www\.)?localwise\.com',    # SSL verification failed
  '^https://(www\.)?mycfsapp\.com',     # SSL hostname mismatch
  '^https://(www\.)?scoutapp\.com',     # SSL hostname mismatch

  # ============================================================================
  # BADGE SERVICES
  # ============================================================================
  '^https://badge\.fury\.io',  # Returns 403 for automated requests

  # ============================================================================
  # SITES THAT RETURN 504 FROM CI
  # ============================================================================
  '^https://reactrails\.com',  # Works locally but 504s from CI

  # ============================================================================
  # PLANNED DEPLOYMENTS NOT YET LIVE
  # ============================================================================
  '^https://ror-spec-dummy\.reactrails\.com',  # spec/dummy demo - deployment pending
  # TODO: Remove this exclusion once licenses.shakacode.com is deployed
  '^https://licenses\.shakacode\.com',  # React on Rails Pro licensing app - deployment pending

  # ============================================================================
  # SITES FROM PROJECTS.MD THAT BLOCK BOTS OR ARE UNRELIABLE
  # ============================================================================
  '^https://blog\.shakacode\.com',  # May block automated requests
  '^https?://(www\.)?foxford\.ru',  # Russian site, often blocks bots
  '^https://(www\.)?airgoat\.com',  # Returns 403
  '^https://(www\.)?first\.io',     # Returns 403
  '^https://(www\.)?estately\.com', # Returns 403
  '^https://hiring\.careerbuilder\.com',  # Returns 403

  # ============================================================================
  # EXTERNAL SITES THAT TIMEOUT DURING CI CHECKS
  # ============================================================================
  '^https?://(www\.)?pivotaltracker\.com',  # Timeout in CI
  '^https?://(www\.)?undeveloped\.com',  # Timeout in CI
  '^https://devchat\.tv',  # Ruby Rogues podcast - times out in CI
  '^https?://chlg\.co',  # URL shortener - times out in CI

  # ============================================================================
  # HISTORICAL RELEASES NEVER TAGGED
  # ============================================================================
  # These versions had CHANGELOG entries created but the git tag + version bump was forgotten.
  # The work was rolled into the next release. See issue #2232 for investigation details.
  '^https://github\.com/shakacode/react_on_rails/compare/8\.0\.6\.\.\.8\.0\.7$',   # 8.0.7 never tagged
  '^https://github\.com/shakacode/react_on_rails/compare/8\.0\.7\.\.\.9\.0\.0$',   # 8.0.7 never tagged
  '^https://github\.com/shakacode/react_on_rails/compare/10\.1\.1\.\.\.10\.1\.2$', # 10.1.2 never tagged
  '^https://github\.com/shakacode/react_on_rails/compare/10\.1\.2\.\.\.10\.1\.3$', # 10.1.2 never tagged

  # ============================================================================
  # DELETED GITHUB USER ACCOUNTS
  # ============================================================================
  # Contributors whose accounts no longer exist
  '^https://github\.com/(alleycat-at-git|Conturbo|jblasco3|nostophilia|railsme|samphilipd|wouldntsavezion)$',

  # ============================================================================
  # PRIVATE REPOSITORIES
  # ============================================================================
  '^https://github\.com/shakacode/react_on_rails_pro/',  # Requires authentication
]

# Exclude paths (regex patterns)
exclude_path = [
  'docs/planning/',           # Contains placeholder links
  '.*/node_modules/.*',       # Dependencies
  '.*/spec/.*',               # Test fixtures
  'SUMMARY.md',               # GitBook TOC with old doc structure links (kept for redirects)
]

# Don't check fragments/anchors (can be flaky)
include_fragments = false

# Cache results to speed up repeated runs
cache = true
max_cache_age = "1d"
