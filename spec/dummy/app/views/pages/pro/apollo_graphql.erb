<% result = react_component_hash(
  "ApolloGraphQLApp",
  prerender: true,
  trace: true,
  props: {
    # since _dummy_session is a http only cookie, it shouldn't be passed to the FE javascript code
    ssrOnlyProps: {
      csrf: form_authenticity_token,
      sessionCookie: cookies["_dummy_session"]
    }
  }) %>

<% content_for :head do %>
  <%= result["apolloStateTag"] %>
<% end %>

This page demonstrates the use of apollo client during server rendering.<br/>

<br/>

Here's the server render-function:
<pre>
<%= File.read(Rails.root.join "client/app/startup/ApolloGraphQLAppServer.jsx") %>
</pre>


Here's the client render-function:
<pre>
<%= File.read(Rails.root.join "client/app/startup/ApolloGraphQLAppClient.jsx") %>
</pre>

Here's the helper method call in the view:

<pre>
  <%%=
    result = react_component_hash(
      "ApolloGraphQLApp",
      prerender: true,
      trace: true,
      # since _dummy_session is a http only cookie, it shouldn't be passed to the FE javascript code
      ssrOnlyProps: {
        csrf: form_authenticity_token,
        sessionCookie: cookies["_dummy_session"]
      }
    )
  %>
</pre>


Don't forget to insert the <b>apolloStateTag</b> field in the document <b>head</b> to enable hydration

<pre>
  <%%= content_for :head do %>
    <%%= result["apolloStateTag"] %>
  <%% end %>
</pre>

Result:
<hr/>


<%= result["componentHtml"] %>
